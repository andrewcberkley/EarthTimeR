unique(df_stories$EarthTime_Story_Name)
sum(unique(df_stories$EarthTime_Story_Name))
count(unique(df_stories$EarthTime_Story_Name))
sum(unique(df_stories$EarthTime_Story_Name))
unique(df_stories$Insight_Area_Name)
#setwd("C:/Users/ABERK/Box/Data_Science_Exploration/ABERK")
#setwd("C:/Users/ABERK/Box/Internal_ Strategic Intelligence/EarthTime/")
Rwefsigapi::set_si_db_credentials("aberk", "password")
con <- Rwefsigapi::open_si_db_connection("DBI", "earthtime")
#df_stories <- dplyr::tibble(openxlsx::readWorkbook("Insight_Areas_with_EarthTime_Stories.xlsx", sheet = 1)) #Error: Failed to fetch row: ERROR:  type "c" does not exist at character 63
df_stories <- readxl::read_excel("C:/Users/ABERK/Box/Internal_ Strategic Intelligence/EarthTime/Insight_Areas_with_EarthTime_Stories.xlsx", sheet = 1, col_names = TRUE)
DBI::dbWriteTable(con, "list-stories", df_stories, overwrite = TRUE)
#DBI::(dbReadTable(con, "list-stories"))
Rwefsigapi::close_connection("DBI", con)
tail(df_stories)
unique(df_stories$Insight_Area_Name)
#setwd("C:/Users/ABERK/Box/Data_Science_Exploration/ABERK")
#setwd("C:/Users/ABERK/Box/Internal_ Strategic Intelligence/EarthTime/")
Rwefsigapi::set_si_db_credentials("aberk", "password")
con <- Rwefsigapi::open_si_db_connection("DBI", "earthtime")
#df_stories <- dplyr::tibble(openxlsx::readWorkbook("Insight_Areas_with_EarthTime_Stories.xlsx", sheet = 1)) #Error: Failed to fetch row: ERROR:  type "c" does not exist at character 63
df_stories <- readxl::read_excel("C:/Users/ABERK/Box/Internal_ Strategic Intelligence/EarthTime/Insight_Areas_with_EarthTime_Stories.xlsx", sheet = 1, col_names = TRUE)
DBI::dbWriteTable(con, "list-stories", df_stories, overwrite = TRUE)
#DBI::(dbReadTable(con, "list-stories"))
Rwefsigapi::close_connection("DBI", con)
tail(df_stories)
unique(df_stories$Insight_Area_Name)
unique(df_stories$EarthTime_Story_Name)
#setwd("C:/Users/ABERK/Box/Data_Science_Exploration/ABERK")
#setwd("C:/Users/ABERK/Box/Internal_ Strategic Intelligence/EarthTime/")
Rwefsigapi::set_si_db_credentials("aberk", "password")
con <- Rwefsigapi::open_si_db_connection("DBI", "earthtime")
#df_stories <- dplyr::tibble(openxlsx::readWorkbook("Insight_Areas_with_EarthTime_Stories.xlsx", sheet = 1)) #Error: Failed to fetch row: ERROR:  type "c" does not exist at character 63
df_stories <- readxl::read_excel("C:/Users/ABERK/Box/Internal_ Strategic Intelligence/EarthTime/Insight_Areas_with_EarthTime_Stories.xlsx", sheet = 1, col_names = TRUE)
DBI::dbWriteTable(con, "list-stories", df_stories, overwrite = TRUE)
#DBI::(dbReadTable(con, "list-stories"))
Rwefsigapi::close_connection("DBI", con)
tail(df_stories)
#setwd("C:/Users/ABERK/Box/Data_Science_Exploration/ABERK")
#setwd("C:/Users/ABERK/Box/Internal_ Strategic Intelligence/EarthTime/")
Rwefsigapi::set_si_db_credentials("aberk", "password")
con <- Rwefsigapi::open_si_db_connection("DBI", "earthtime")
#df_stories <- dplyr::tibble(openxlsx::readWorkbook("Insight_Areas_with_EarthTime_Stories.xlsx", sheet = 1)) #Error: Failed to fetch row: ERROR:  type "c" does not exist at character 63
df_stories <- readxl::read_excel("C:/Users/ABERK/Box/Internal_ Strategic Intelligence/EarthTime/Insight_Areas_with_EarthTime_Stories.xlsx", sheet = 1, col_names = TRUE)
DBI::dbWriteTable(con, "list-stories", df_stories, overwrite = TRUE)
#DBI::(dbReadTable(con, "list-stories"))
Rwefsigapi::close_connection("DBI", con)
tail(df_stories)
#setwd("C:/Users/ABERK/Box/Data_Science_Exploration/ABERK")
#setwd("C:/Users/ABERK/Box/Internal_ Strategic Intelligence/EarthTime/")
Rwefsigapi::set_si_db_credentials("aberk", "password")
con <- Rwefsigapi::open_si_db_connection("DBI", "earthtime")
#df_stories <- dplyr::tibble(openxlsx::readWorkbook("Insight_Areas_with_EarthTime_Stories.xlsx", sheet = 1)) #Error: Failed to fetch row: ERROR:  type "c" does not exist at character 63
df_stories <- readxl::read_excel("C:/Users/ABERK/Box/Internal_ Strategic Intelligence/EarthTime/Insight_Areas_with_EarthTime_Stories.xlsx", sheet = 1, col_names = TRUE)
DBI::dbWriteTable(con, "list-stories", df_stories, overwrite = TRUE)
#DBI::(dbReadTable(con, "list-stories"))
Rwefsigapi::close_connection("DBI", con)
tail(df_stories)
#setwd("C:/Users/ABERK/Box/Data_Science_Exploration/ABERK")
#setwd("C:/Users/ABERK/Box/Internal_ Strategic Intelligence/EarthTime/")
Rwefsigapi::set_si_db_credentials("aberk", "password")
con <- Rwefsigapi::open_si_db_connection("DBI", "earthtime")
#df_stories <- dplyr::tibble(openxlsx::readWorkbook("Insight_Areas_with_EarthTime_Stories.xlsx", sheet = 1)) #Error: Failed to fetch row: ERROR:  type "c" does not exist at character 63
df_stories <- readxl::read_excel("C:/Users/ABERK/Box/Internal_ Strategic Intelligence/EarthTime/Insight_Areas_with_EarthTime_Stories.xlsx", sheet = 1, col_names = TRUE)
DBI::dbWriteTable(con, "list-stories", df_stories, overwrite = TRUE)
#DBI::(dbReadTable(con, "list-stories"))
Rwefsigapi::close_connection("DBI", con)
tail(df_stories)
View(df_stories)
#setwd("C:/Users/ABERK/Box/Data_Science_Exploration/ABERK")
#setwd("C:/Users/ABERK/Box/Internal_ Strategic Intelligence/EarthTime/")
Rwefsigapi::set_si_db_credentials("aberk", "password")
#con <- Rwefsigapi::open_si_db_connection("DBI", "earthtime")
con <- DBI::dbConnect(
RPostgres::Postgres(),
dbname = "earthtime",
host = "192.168.166.56",
port = 5432,
user = "aberk",
password = "password"
)
#df_stories <- dplyr::tibble(openxlsx::readWorkbook("Insight_Areas_with_EarthTime_Stories.xlsx", sheet = 1)) #Error: Failed to fetch row: ERROR:  type "c" does not exist at character 63
df_stories <- readxl::read_excel("C:/Users/ABERK/Box/Internal_ Strategic Intelligence/EarthTime/Insight_Areas_with_EarthTime_Stories.xlsx", sheet = 1, col_names = TRUE)
DBI::dbWriteTable(con, "list-stories", df_stories, overwrite = TRUE)
#DBI::(dbReadTable(con, "list-stories"))
#Rwefsigapi::close_connection("DBI", con)
dbDisconnect(con)
tail(df_stories)
#db_table_check <- as.data.frame(dbReadTable(con, "list-stories"))
#setwd("C:/Users/ABERK/Box/Data_Science_Exploration/ABERK")
#setwd("C:/Users/ABERK/Box/Internal_ Strategic Intelligence/EarthTime/")
Rwefsigapi::set_si_db_credentials("aberk", "password")
#con <- Rwefsigapi::open_si_db_connection("DBI", "earthtime")
con <- DBI::dbConnect(
RPostgres::Postgres(),
dbname = "earthtime",
host = "192.168.166.56",
port = 5432,
user = "aberk",
password = "password"
)
#df_stories <- dplyr::tibble(openxlsx::readWorkbook("Insight_Areas_with_EarthTime_Stories.xlsx", sheet = 1)) #Error: Failed to fetch row: ERROR:  type "c" does not exist at character 63
df_stories <- readxl::read_excel("C:/Users/ABERK/Box/Internal_ Strategic Intelligence/EarthTime/Insight_Areas_with_EarthTime_Stories.xlsx", sheet = 1, col_names = TRUE)
DBI::dbWriteTable(con, "list-stories", df_stories, overwrite = TRUE)
#DBI::(dbReadTable(con, "list-stories"))
#Rwefsigapi::close_connection("DBI", con)
dbDisconnect(con)
tail(df_stories)
#db_table_check <- as.data.frame(dbReadTable(con, "list-stories"))
db_table_check <- as.data.frame(dbReadTable(con, "list-stories"))
Rwefsigapi::set_si_db_credentials("aberk", "password")
#con <- Rwefsigapi::open_si_db_connection("DBI", "earthtime")
con <- DBI::dbConnect(
RPostgres::Postgres(),
dbname = "earthtime",
host = "192.168.166.56",
port = 5432,
user = "aberk",
password = "password"
)
df_stories <- readxl::read_excel("C:/Users/ABERK/Box/Internal_ Strategic Intelligence/EarthTime/Insight_Areas_with_EarthTime_Stories.xlsx", sheet = 1, col_names = TRUE)
DBI::dbWriteTable(con, "list-stories", df_stories, overwrite = TRUE)
db_table_check <- as.data.frame(dbReadTable(con, "list-stories"))
library(DBI)
db_table_check <- as.data.frame(dbReadTable(con, "list-stories"))
View(db_table_check)
dbDisconnect(con)
saveRDS(installed.packages(), file="/tmp/pkgs.rds")
saveRDS(installed.packages(), file="pkgs.rds")
pkgs <- readRDS("pkgs.rds"); install.packages(rownames(pkgs))
install.packages(rownames(pkgs))
install.packages(rownames(pkgs))
install.packages(rownames(pkgs))
install.packages(rownames(pkgs))
install.packages(rownames(pkgs))
pkgs <- readRDS("pkgs.rds")
install.packages(rownames(pkgs))
install.packages(rownames(pkgs))
install.packages(rownames(pkgs))
install.packages(rownames(pkgs))
update.packages(checkBuilt = TRUE, ask = FALSE)
install.packages("XLConnect")
install.packages("Rtools")
update.packages(checkBuilt = TRUE, ask = FALSE)
pkgs <- readRDS("pkgs.rds")
install.packages(rownames(pkgs))
install.packages(rownames(pkgs))
install.packages(rownames(pkgs))
install.packages(rownames(pkgs))
update.packages(checkBuilt = TRUE, ask = FALSE)
update.packages(checkBuilt = TRUE, ask = FALSE)
update.packages(checkBuilt = TRUE, ask = FALSE)
SAdata <- read.csv("C:/Users/ABERK/OneDrive - World Economic Forum/Desktop/SAdata.csv")
View(SAdata)
colnames(SAdata)
unique(SAdata$Race)
pdftools::pdf_data("C:/Users/ABERK/OneDrive - World Economic Forum/Desktop/PG_2020.06.25_Global-Views-Homosexuality_TOPLINE.pdf")
global_views_on_homosexuality <- pdftools::pdf_data("C:/Users/ABERK/OneDrive - World Economic Forum/Desktop/PG_2020.06.25_Global-Views-Homosexuality_TOPLINE.pdf")
View(global_views_on_homosexuality)
library(tabulizer)
install.packages("tabulizer")
library(tabulizer)
install.packages(rJava)
install.packages("rJava")
library(tabulizer)
options(java.parameters = "-Xmx12000m")
library(tabulizer)
remove.packages("rJava", lib="~/R/win-library/4.1")
remove.packages("tabulizer", lib="~/R/win-library/4.1")
remove.packages("tabulizerjars", lib="~/R/win-library/4.1")
install.packages("rJava")
install.packages("tabulizer")
library(tabulizer)
if (!require("remotes")) {
install.packages("remotes")
}
# on 64-bit Windows
remotes::install_github(c("ropensci/tabulizerjars", "ropensci/tabulizer"), INSTALL_opts = "--no-multiarch")
library(tabulizer)
if (!require("remotes")) {
install.packages("remotes")
}
# on 64-bit Windows
remotes::install_github(c("ropensci/tabulizerjars"), INSTALL_opts = "--no-multiarch")
remove.packages("tabulizerjars", lib="~/R/win-library/4.1")
remove.packages("tabulizer", lib="~/R/win-library/4.1")
if (!require("remotes")) {
install.packages("remotes")
}
# on 64-bit Windows
remotes::install_github(c("ropensci/tabulizerjars"), INSTALL_opts = "--no-multiarch")
if (!require("remotes")) {
install.packages("remotes")
}
# on 64-bit Windows
remotes::install_github(c(""ropensci/tabulizer"), INSTALL_opts = "--no-multiarch")
if (!require("remotes")) {
install.packages("remotes")
}
# on 64-bit Windows
remotes::install_github(c(ropensci/tabulizer"), INSTALL_opts = "--no-multiarch")
if (!require("remotes")) {
install.packages("remotes")
}
# on 64-bit Windows
remotes::install_github(c("ropensci/tabulizer"), INSTALL_opts = "--no-multiarch")
if (!require("remotes")) {
install.packages("remotes")
}
# on 64-bit Windows
remotes::install_github(c("ropensci/tabulizerjars"), INSTALL_opts = "--no-multiarch")
install.packages("tabulizer")
library(tabulizer)
options(java.parameters = "-Xmx12000m")
library(tabulizer)
library(rJava)
remotes::install_github("forum-intelligence/tmvisualizer")
x <- as.Date("2018-10-01")
as.month(x)
month(x)
attr(x)
[ ] v1<-list(1,2,3)
v2<-list(c(4,5,6))
vbound<-cbind(v1,v2)
v1<-list(1,2,3)
v2<-list(c(4,5,6))
vbound<-cbind(v1,v2)
v1<-c(1,2,3)
v2<-list(4,5,6))
vbound<-cbind(v1,v2)
v1<-list(1,2,3)
v2<-list(c(4,5,6))
vbound<-cbind(v1,v2)
ls(char="V")
ls(char<-"V")
ls(pat="V")
x <- c(12L,6L,10L,8L,15L,14L,19L,18L,23L,59L)
median(x)
typeof(median(x))
url <- "https://archive.org/compress/spanishpod"
destfile <- "C:/Users/ABERK/Box/The_Definitive_ABERK_Miscellaneous/aberk_learning_award_2021/language_self_study_materials/spanish/spanishpod/"
download.file(url, destfile)
destfile <- "C:/Users/ABERK/Desktop/"
download.file(url, destfile)
destfile <- "C:/Users/ABERK/Box/The_Definitive_ABERK_Miscellaneous/aberk_learning_award_2021/language_self_study_materials/spanish/spanishpod/"
pg <- readLines(url)
url <- "https://archive.org/download/spanishpod"
pg <- readLines(url)
head(pg)
pg
url <- "https://archive.org/compress/spanishpod"
library(rvest)
pg <- read_html(url)
testing <- read.csv("C:/Users/ABERK/OneDrive - World Economic Forum/Desktop/testing.CSV", comment.char="#")
View(testing)
devtools::install_github(“rstudio/r2d3”)
install.packages("devtools")
devtools::install_github(“rstudio/r2d3”)
devtools::install_github('rstudio/r2d3')
initial_ingestion  <- function(dataframe, data_layer_name, display_sheet_in_browser=FALSE, share_with_anyone=TRUE){
Sheet1 <- dataframe
new_sheet <- googlesheets4::gs4_create(name = data_layer_name, sheets = Sheet1)
place_name_here <- deparse(substitute(dataframe))  # Apply deparse & substitute # Show object name as character string
if(display_sheet_in_browser==FALSE){
cat(crayon::green$bold("\nCONGRATULATIONS:" , reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded and is ready to be used in EarthTime!\n\n")))))
}
else{
googlesheets4::gs4_browse(new_sheet)
}
if(share_with_anyone==TRUE){
suppressMessages(googledrive::drive_share_anyone(googledrive::as_id(new_sheet)))
cat(crayon::yellow$bold("\nATTENTION:" %+% reset(" Sharing permissions for data in " %+% bgYellow(place_name_here %+% reset(" are now set to anyone on the internet with this link can view.\n\n")))))
}
else{
cat(crayon::red$bold$underline("\nWARNING:" %+% reset(" You've chosen to not make " %+% bgYellow(place_name_here %+% reset(" available to anyone with the link. Please keep in mind that you will need to later change permissions to 'anyone with the link' if you want this data layer to be available in EarthTime!\n\n")))))
}
GID <- googlesheets4::sheet_properties(new_sheet)[1,3] #Extracts GID of first sheet in the workbook-ideally this should be the only sheet in the workbook
workbook_id <- read.table(text=gsub("\\ID:", " ", new_sheet))
assign(paste0(place_name_here, "_URL"), paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/",workbook_id,"/export?format=csv&gid=",GID), envir = globalenv())
cat(crayon::magenta$bold("\nNOTE:" %+% reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded in Google Sheets. Its URL is " %+% blue$underline(paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/", workbook_id, "/export?format=csv&gid=", GID) %+% reset(" and can now be copied from the Global Environment!\n\n")))))))
}
setwd(file.path(Sys.getenv('my_dir'),'2019/01/Innovate_UK/'))
UK <- read.csv("innovate_UK_clean_14-01-2019.csv", stringsAsFactors=FALSE)
UK <- UK[, -c(1:2, 6)]
UK2 <- UK[1:500,1:4]
test <- choropleth(UK, "Competition_Year", "Grant_Offered_.GBP.")
library("EarthTimeR")
initial_ingestion(UK2, "1xBan-K9cq5xl0sw_l2JyZpVk-XJKJcrGrGKMM36uJM8", "899853170", share_with_anyone = FALSE)
initial_ingestion  <- function(dataframe, data_layer_name, display_sheet_in_browser=FALSE, share_with_anyone=TRUE){
Sheet1 <- dataframe
new_sheet <- googlesheets4::gs4_create(name = data_layer_name, sheets = Sheet1)
place_name_here <- deparse(substitute(dataframe))  # Apply deparse & substitute # Show object name as character string
if(display_sheet_in_browser==FALSE){
cat(crayon::green$bold("\nCONGRATULATIONS:" , reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded and is ready to be used in EarthTime!\n\n")))))
}
else{
googlesheets4::gs4_browse(new_sheet)
}
if(share_with_anyone==TRUE){
suppressMessages(googledrive::drive_share_anyone(googledrive::as_id(new_sheet)))
cat(crayon::yellow$bold("\nATTENTION:" %+% reset(" Sharing permissions for data in " %+% bgYellow(place_name_here %+% reset(" are now set to anyone on the internet with this link can view.\n\n")))))
}
else{
cat(crayon::red$bold$underline("\nWARNING:" %+% reset(" You've chosen to not make " %+% bgYellow(place_name_here %+% reset(" available to anyone with the link. Please keep in mind that you will need to later change permissions to 'anyone with the link' if you want this data layer to be available in EarthTime!\n\n")))))
}
GID <- googlesheets4::sheet_properties(new_sheet)[1,3] #Extracts GID of first sheet in the workbook-ideally this should be the only sheet in the workbook
workbook_id <- read.table(text=gsub("\\ID:", " ", new_sheet))
assign(paste0(place_name_here, "_URL"), paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/",workbook_id,"/export?format=csv&gid=",GID), envir = globalenv())
cat(crayon::magenta$bold("\nNOTE:" %+% reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded in Google Sheets. Its URL is " %+% blue$underline(paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/", workbook_id, "/export?format=csv&gid=", GID) %+% reset(" and can now be copied from the Global Environment!\n\n")))))))
}
initial_ingestion(UK2, "1xBan-K9cq5xl0sw_l2JyZpVk-XJKJcrGrGKMM36uJM8", "899853170", share_with_anyone = FALSE)
initial_ingestion  <- function(dataframe, data_layer_name, display_sheet_in_browser=FALSE, share_with_anyone=TRUE){
Sheet1 <- dataframe
new_sheet <- googlesheets4::gs4_create(name = data_layer_name, sheets = Sheet1)
place_name_here <- deparse(substitute(dataframe))  # Apply deparse & substitute # Show object name as character string
if(display_sheet_in_browser==FALSE){
cat(crayon::green$bold("\nCONGRATULATIONS:" , reset(" The data for " , bgYellow(place_name_here , reset(" has been uploaded and is ready to be used in EarthTime!\n\n")))))
}
else{
googlesheets4::gs4_browse(new_sheet)
}
if(share_with_anyone==TRUE){
suppressMessages(googledrive::drive_share_anyone(googledrive::as_id(new_sheet)))
cat(crayon::yellow$bold("\nATTENTION:" , reset(" Sharing permissions for data in " , bgYellow(place_name_here , reset(" are now set to anyone on the internet with this link can view.\n\n")))))
}
else{
cat(crayon::red$bold$underline("\nWARNING:" , reset(" You've chosen to not make " , bgYellow(place_name_here , reset(" available to anyone with the link. Please keep in mind that you will need to later change permissions to 'anyone with the link' if you want this data layer to be available in EarthTime!\n\n")))))
}
GID <- googlesheets4::sheet_properties(new_sheet)[1,3] #Extracts GID of first sheet in the workbook-ideally this should be the only sheet in the workbook
workbook_id <- read.table(text=gsub("\\ID:", " ", new_sheet))
assign(paste0(place_name_here, "_URL"), paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/",workbook_id,"/export?format=csv&gid=",GID), envir = globalenv())
cat(crayon::magenta$bold("\nNOTE:" , reset(" The data for " , bgYellow(place_name_here , reset(" has been uploaded in Google Sheets. Its URL is " , blue$underline(paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/", workbook_id, "/export?format=csv&gid=", GID) , reset(" and can now be copied from the Global Environment!\n\n")))))))
}
initial_ingestion(UK2, "1xBan-K9cq5xl0sw_l2JyZpVk-XJKJcrGrGKMM36uJM8", "899853170", share_with_anyone = FALSE)
initial_ingestion  <- function(dataframe, data_layer_name, display_sheet_in_browser=FALSE, share_with_anyone=TRUE){
Sheet1 <- dataframe
new_sheet <- googlesheets4::gs4_create(name = data_layer_name, sheets = Sheet1)
place_name_here <- deparse(substitute(dataframe))  # Apply deparse & substitute # Show object name as character string
if(display_sheet_in_browser==FALSE){
cat(crayon::green$bold("\nCONGRATULATIONS:" , crayon::reset(" The data for " , bgYellow(place_name_here , crayon::reset(" has been uploaded and is ready to be used in EarthTime!\n\n")))))
}
else{
googlesheets4::gs4_browse(new_sheet)
}
if(share_with_anyone==TRUE){
suppressMessages(googledrive::drive_share_anyone(googledrive::as_id(new_sheet)))
cat(crayon::yellow$bold("\nATTENTION:" , crayon::reset(" Sharing permissions for data in " , bgYellow(place_name_here , crayon::reset(" are now set to anyone on the internet with this link can view.\n\n")))))
}
else{
cat(crayon::red$bold$underline("\nWARNING:" , crayon::reset(" You've chosen to not make " , bgYellow(place_name_here , crayon::reset(" available to anyone with the link. Please keep in mind that you will need to later change permissions to 'anyone with the link' if you want this data layer to be available in EarthTime!\n\n")))))
}
GID <- googlesheets4::sheet_properties(new_sheet)[1,3] #Extracts GID of first sheet in the workbook-ideally this should be the only sheet in the workbook
workbook_id <- read.table(text=gsub("\\ID:", " ", new_sheet))
assign(paste0(place_name_here, "_URL"), paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/",workbook_id,"/export?format=csv&gid=",GID), envir = globalenv())
cat(crayon::magenta$bold("\nNOTE:" , crayon::reset(" The data for " , bgYellow(place_name_here , crayon::reset(" has been uploaded in Google Sheets. Its URL is " , blue$underline(paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/", workbook_id, "/export?format=csv&gid=", GID) , crayon::reset(" and can now be copied from the Global Environment!\n\n")))))))
}
initial_ingestion(UK2, "1xBan-K9cq5xl0sw_l2JyZpVk-XJKJcrGrGKMM36uJM8", "899853170", share_with_anyone = FALSE)
initial_ingestion  <- function(dataframe, data_layer_name, display_sheet_in_browser=FALSE, share_with_anyone=TRUE){
Sheet1 <- dataframe
new_sheet <- googlesheets4::gs4_create(name = data_layer_name, sheets = Sheet1)
place_name_here <- deparse(substitute(dataframe))  # Apply deparse & substitute # Show object name as character string
if(display_sheet_in_browser==FALSE){
cat(crayon::green$bold("\nCONGRATULATIONS:" , crayon::reset(" The data for " , bgYellow(place_name_here , crayon::reset(" has been uploaded and is ready to be used in EarthTime!\n\n")))))
}
else{
googlesheets4::gs4_browse(new_sheet)
}
if(share_with_anyone==TRUE){
suppressMessages(googledrive::drive_share_anyone(googledrive::as_id(new_sheet)))
cat(crayon::yellow$bold("\nATTENTION:" , crayon::reset(" Sharing permissions for data in " , bgYellow(place_name_here , crayon::reset(" are now set to anyone on the internet with this link can view.\n\n")))))
}
else{
cat(crayon::red$bold$underline("\nWARNING:" , crayon::reset(" You've chosen to not make " , crayon::bgYellow(place_name_here , crayon::reset(" available to anyone with the link. Please keep in mind that you will need to later change permissions to 'anyone with the link' if you want this data layer to be available in EarthTime!\n\n")))))
}
GID <- googlesheets4::sheet_properties(new_sheet)[1,3] #Extracts GID of first sheet in the workbook-ideally this should be the only sheet in the workbook
workbook_id <- read.table(text=gsub("\\ID:", " ", new_sheet))
assign(paste0(place_name_here, "_URL"), paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/",workbook_id,"/export?format=csv&gid=",GID), envir = globalenv())
cat(crayon::magenta$bold("\nNOTE:" , crayon::reset(" The data for " , bgYellow(place_name_here , crayon::reset(" has been uploaded in Google Sheets. Its URL is " , blue$underline(paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/", workbook_id, "/export?format=csv&gid=", GID) , crayon::reset(" and can now be copied from the Global Environment!\n\n")))))))
}
initial_ingestion(UK2, "testing", share_with_anyone = FALSE)
initial_ingestion  <- function(dataframe, data_layer_name, display_sheet_in_browser=FALSE, share_with_anyone=TRUE){
Sheet1 <- dataframe
new_sheet <- googlesheets4::gs4_create(name = data_layer_name, sheets = Sheet1)
place_name_here <- deparse(substitute(dataframe))  # Apply deparse & substitute # Show object name as character string
if(display_sheet_in_browser==FALSE){
cat(crayon::green$bold("\nCONGRATULATIONS:" , crayon::reset(" The data for " , bgYellow(place_name_here , crayon::reset(" has been uploaded and is ready to be used in EarthTime!\n\n")))))
}
else{
googlesheets4::gs4_browse(new_sheet)
}
if(share_with_anyone==TRUE){
suppressMessages(googledrive::drive_share_anyone(googledrive::as_id(new_sheet)))
cat(crayon::yellow$bold("\nATTENTION:" , crayon::reset(" Sharing permissions for data in " , crayon::bgYellow(place_name_here , crayon::reset(" are now set to anyone on the internet with this link can view.\n\n")))))
}
else{
cat(crayon::red$bold$underline("\nWARNING:" , crayon::reset(" You've chosen to not make " , crayon::bgYellow(place_name_here , crayon::reset(" available to anyone with the link. Please keep in mind that you will need to later change permissions to 'anyone with the link' if you want this data layer to be available in EarthTime!\n\n")))))
}
GID <- googlesheets4::sheet_properties(new_sheet)[1,3] #Extracts GID of first sheet in the workbook-ideally this should be the only sheet in the workbook
workbook_id <- read.table(text=gsub("\\ID:", " ", new_sheet))
assign(paste0(place_name_here, "_URL"), paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/",workbook_id,"/export?format=csv&gid=",GID), envir = globalenv())
cat(crayon::magenta$bold("\nNOTE:" , crayon::reset(" The data for " , bgYellow(place_name_here , crayon::reset(" has been uploaded in Google Sheets. Its URL is " , blue$underline(paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/", workbook_id, "/export?format=csv&gid=", GID) , crayon::reset(" and can now be copied from the Global Environment!\n\n")))))))
}
initial_ingestion(UK2, "testing", share_with_anyone = FALSE)
initial_ingestion  <- function(dataframe, data_layer_name, display_sheet_in_browser=FALSE, share_with_anyone=TRUE){
Sheet1 <- dataframe
new_sheet <- googlesheets4::gs4_create(name = data_layer_name, sheets = Sheet1)
place_name_here <- deparse(substitute(dataframe))  # Apply deparse & substitute # Show object name as character string
if(display_sheet_in_browser==FALSE){
cat(crayon::green$bold("\nCONGRATULATIONS:" , crayon::reset(" The data for " , bgYellow(place_name_here , crayon::reset(" has been uploaded and is ready to be used in EarthTime!\n\n")))))
}
else{
googlesheets4::gs4_browse(new_sheet)
}
if(share_with_anyone==TRUE){
suppressMessages(googledrive::drive_share_anyone(googledrive::as_id(new_sheet)))
cat(crayon::yellow$bold("\nATTENTION:" , crayon::reset(" Sharing permissions for data in " , crayon::bgYellow(place_name_here , crayon::reset(" are now set to anyone on the internet with this link can view.\n\n")))))
}
else{
cat(crayon::red$bold$underline("\nWARNING:" , crayon::reset(" You've chosen to not make " , crayon::bgYellow(place_name_here , crayon::reset(" available to anyone with the link. Please keep in mind that you will need to later change permissions to 'anyone with the link' if you want this data layer to be available in EarthTime!\n\n")))))
}
GID <- googlesheets4::sheet_properties(new_sheet)[1,3] #Extracts GID of first sheet in the workbook-ideally this should be the only sheet in the workbook
workbook_id <- read.table(text=gsub("\\ID:", " ", new_sheet))
assign(paste0(place_name_here, "_URL"), paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/",workbook_id,"/export?format=csv&gid=",GID), envir = globalenv())
cat(crayon::magenta$bold("\nNOTE:" , crayon::reset(" The data for " , crayon::bgYellow(place_name_here , crayon::reset(" has been uploaded in Google Sheets. Its URL is " , blue$underline(paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/", workbook_id, "/export?format=csv&gid=", GID) , crayon::reset(" and can now be copied from the Global Environment!\n\n")))))))
}
initial_ingestion(UK2, "testing", share_with_anyone = FALSE)
initial_ingestion  <- function(dataframe, data_layer_name, display_sheet_in_browser=FALSE, share_with_anyone=TRUE){
Sheet1 <- dataframe
new_sheet <- googlesheets4::gs4_create(name = data_layer_name, sheets = Sheet1)
place_name_here <- deparse(substitute(dataframe))  # Apply deparse & substitute # Show object name as character string
if(display_sheet_in_browser==FALSE){
cat(crayon::green$bold("\nCONGRATULATIONS:" , crayon::reset(" The data for " , crayon::bgYellow(place_name_here , crayon::reset(" has been uploaded and is ready to be used in EarthTime!\n\n")))))
}
else{
googlesheets4::gs4_browse(new_sheet)
}
if(share_with_anyone==TRUE){
suppressMessages(googledrive::drive_share_anyone(googledrive::as_id(new_sheet)))
cat(crayon::yellow$bold("\nATTENTION:" , crayon::reset(" Sharing permissions for data in " , crayon::bgYellow(place_name_here , crayon::reset(" are now set to anyone on the internet with this link can view.\n\n")))))
}
else{
cat(crayon::red$bold$underline("\nWARNING:" , crayon::reset(" You've chosen to not make " , crayon::bgYellow(place_name_here , crayon::reset(" available to anyone with the link. Please keep in mind that you will need to later change permissions to 'anyone with the link' if you want this data layer to be available in EarthTime!\n\n")))))
}
GID <- googlesheets4::sheet_properties(new_sheet)[1,3] #Extracts GID of first sheet in the workbook-ideally this should be the only sheet in the workbook
workbook_id <- read.table(text=gsub("\\ID:", " ", new_sheet))
assign(paste0(place_name_here, "_URL"), paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/",workbook_id,"/export?format=csv&gid=",GID), envir = globalenv())
cat(crayon::magenta$bold("\nNOTE:" , crayon::reset(" The data for " , crayon::bgYellow(place_name_here , crayon::reset(" has been uploaded in Google Sheets. Its URL is " , blue$underline(paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/", workbook_id, "/export?format=csv&gid=", GID) , crayon::reset(" and can now be copied from the Global Environment!\n\n")))))))
}
initial_ingestion(UK2, "testing", share_with_anyone = FALSE)
initial_ingestion  <- function(dataframe, data_layer_name, display_sheet_in_browser=FALSE, share_with_anyone=TRUE){
Sheet1 <- dataframe
new_sheet <- googlesheets4::gs4_create(name = data_layer_name, sheets = Sheet1)
place_name_here <- deparse(substitute(dataframe))  # Apply deparse & substitute # Show object name as character string
if(display_sheet_in_browser==FALSE){
cat(crayon::green$bold("\nCONGRATULATIONS:" , crayon::reset(" The data for " , crayon::bgYellow(place_name_here , crayon::reset(" has been uploaded and is ready to be used in EarthTime!\n\n")))))
}
else{
googlesheets4::gs4_browse(new_sheet)
}
if(share_with_anyone==TRUE){
suppressMessages(googledrive::drive_share_anyone(googledrive::as_id(new_sheet)))
cat(crayon::yellow$bold("\nATTENTION:" , crayon::reset(" Sharing permissions for data in " , crayon::bgYellow(place_name_here , crayon::reset(" are now set to anyone on the internet with this link can view.\n\n")))))
}
else{
cat(crayon::red$bold$underline("\nWARNING:" , crayon::reset(" You've chosen to not make " , crayon::bgYellow(place_name_here , crayon::reset(" available to anyone with the link. Please keep in mind that you will need to later change permissions to 'anyone with the link' if you want this data layer to be available in EarthTime!\n\n")))))
}
GID <- googlesheets4::sheet_properties(new_sheet)[1,3] #Extracts GID of first sheet in the workbook-ideally this should be the only sheet in the workbook
workbook_id <- read.table(text=gsub("\\ID:", " ", new_sheet))
assign(paste0(place_name_here, "_URL"), paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/",workbook_id,"/export?format=csv&gid=",GID), envir = globalenv())
cat(crayon::magenta$bold("\nNOTE:" , crayon::reset(" The data for " , crayon::bgYellow(place_name_here , crayon::reset(" has been uploaded in Google Sheets. Its URL is " , crayon::blue$underline(paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/", workbook_id, "/export?format=csv&gid=", GID) , crayon::reset(" and can now be copied from the Global Environment!\n\n")))))))
}
initial_ingestion(UK2, "testing", share_with_anyone = FALSE)
overwrite_sheet  <- function(dataframe, spreadsheetId, sheetId, sheet_name = NULL, display_sheet_in_browser=FALSE, share_with_anyone=TRUE){
if(missing(sheet_name)){
ss <- googlesheets4::as_sheets_id(paste0("https://docs.google.com/spreadsheets/d/", spreadsheetId, "/edit#gid=", sheetId))
googlesheets4::sheet_write(dataframe, ss = ss, sheet = "Sheet1")
}
else{
ss <- googlesheets4::as_sheets_id(paste0("https://docs.google.com/spreadsheets/d/", spreadsheetId, "/edit#gid=", sheetId))
googlesheets4::sheet_write(dataframe, ss = ss, sheet = sheet_name)
}
place_name_here <- deparse(substitute(dataframe))  # Apply deparse & substitute # Show object name as character string
if(display_sheet_in_browser==FALSE){
cat(crayon::green$bold("\nCONGRATULATIONS:" , crayon::reset(" The data for " , crayon::bgYellow(place_name_here , crayon::reset(" has been uploaded and is ready to be used in EarthTime!\n\n")))))
}
else{
googlesheets4::gs4_browse(ss)
}
if(share_with_anyone==TRUE){
suppressMessages(googledrive::drive_share_anyone(googledrive::as_id(ss)))
cat(crayon::yellow$bold("\nATTENTION:" , crayon::reset(" Sharing permissions for data in " , crayon::bgYellow(place_name_here , crayon::reset(" are now set to anyone on the internet with this link can view.\n\n")))))
}
else{
cat(crayon::red$bold$underline("\nWARNING:" , crayon::reset(" You've chosen to not make " , crayon::bgYellow(place_name_here , crayon::reset(" available to anyone with the link. Please keep in mind that you will need to later change permissions to 'anyone with the link' if you want this data layer to be available in EarthTime!\n\n")))))
}
GID <- googlesheets4::sheet_properties(ss)[1,3] #Extracts GID of first sheet in the workbook-ideally this should be the only sheet in the workbook
workbook_id <- read.table(text=gsub("\\ID:", " ", ss))
assign(paste0(place_name_here, "_URL"), paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/",workbook_id,"/export?format=csv&gid=",GID), envir = globalenv())
cat(crayon::magenta$bold("\nNOTE:" , crayon::reset(" The data for " , crayon::bgYellow(place_name_here , crayon::reset(" has been uploaded in Google Sheets. Its URL is " , crayon::blue$underline(paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/", workbook_id, "/export?format=csv&gid=", GID) , crayon::reset(" and can now be copied from the Global Environment!\n\n")))))))
}
overwrite_sheet(UK2, "1xBan-K9cq5xl0sw_l2JyZpVk-XJKJcrGrGKMM36uJM8", "899853170", share_with_anyone = FALSE)
.rs.restartR()
library("devtools")
library("roxygen2")
setwd("C:/Users/ABERK/Box/The_Definitive_ABERK_Data_Science_Folder")
setwd("./EarthTimeR")
document()
library("devtools")
library("roxygen2")
setwd("C:/Users/ABERK/Box/The_Definitive_ABERK_Data_Science_Folder")
setwd("./EarthTimeR")
document()
