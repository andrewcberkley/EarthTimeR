googlesheets4::sheet_write(dataframe, ss = ss, sheet = "Sheet1")
}
else{
ss <- googlesheets4::as_sheets_id(paste0("https://docs.google.com/spreadsheets/d/", spreadsheetId, "/edit#gid=", sheetId))
googlesheets4::sheet_write(dataframe, ss = ss, sheet = sheet_name)
}
place_name_here <- deparse(substitute(dataframe))  # Apply deparse & substitute # Show object name as character string
if(display_sheet_in_browser==FALSE){
cat(crayon::green$bold("\nCONGRATULATIONS:" %+% reset(" The data for " %+% bgYellow(place_name_here, %+% reset(" has been uploaded and is ready to be used in EarthTime!\n\n")))))
}
else{
googlesheets4::gs4_browse(ss)
}
if(share_with_anyone==TRUE){
googledrive::drive_share_anyone(googledrive::as_id(ss))
}
else{
cat(paste0("WARNING: You've chosen to not make  '", place_name_here, "' available to anyone with the link. Please keep in mind that you will need to later change permissions to 'anyone with the link' if you want this data layer to be available in EarthTime!\n\n"))
}
GID <- googlesheets4::sheet_properties(ss)[1,3] #Extracts GID of first sheet in the workbook—ideally this should be the only sheet in the workbook
workbook_id <- read.table(text=gsub("\\ID:", " ", ss))
assign(paste0(place_name_here, "_URL"), paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/",workbook_id,"/export?format=csv&gid=",GID), envir = globalenv())
cat(paste0("The data for '", place_name_here, "' has been uploaded in Google Sheets. Its URL is ", "'https://docs-proxy.cmucreatelab.org/spreadsheets/d/",workbook_id,"/export?format=csv&gid=",GID, "' and can now be copied from the Global Environment.\n\n"))
}
overwrite_sheet  <- function(dataframe, spreadsheetId, sheetId, sheet_name = NULL, display_sheet_in_browser=FALSE, share_with_anyone=TRUE){
if(missing(sheet_name)){
ss <- googlesheets4::as_sheets_id(paste0("https://docs.google.com/spreadsheets/d/", spreadsheetId, "/edit#gid=", sheetId))
googlesheets4::sheet_write(dataframe, ss = ss, sheet = "Sheet1")
}
else{
ss <- googlesheets4::as_sheets_id(paste0("https://docs.google.com/spreadsheets/d/", spreadsheetId, "/edit#gid=", sheetId))
googlesheets4::sheet_write(dataframe, ss = ss, sheet = sheet_name)
}
place_name_here <- deparse(substitute(dataframe))  # Apply deparse & substitute # Show object name as character string
if(display_sheet_in_browser==FALSE){
cat(crayon::green$bold("\nCONGRATULATIONS:" %+% reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded and is ready to be used in EarthTime!\n\n")))))
}
else{
googlesheets4::gs4_browse(ss)
}
if(share_with_anyone==TRUE){
googledrive::drive_share_anyone(googledrive::as_id(ss))
}
else{
cat(paste0("WARNING: You've chosen to not make  '", place_name_here, "' available to anyone with the link. Please keep in mind that you will need to later change permissions to 'anyone with the link' if you want this data layer to be available in EarthTime!\n\n"))
}
GID <- googlesheets4::sheet_properties(ss)[1,3] #Extracts GID of first sheet in the workbook—ideally this should be the only sheet in the workbook
workbook_id <- read.table(text=gsub("\\ID:", " ", ss))
assign(paste0(place_name_here, "_URL"), paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/",workbook_id,"/export?format=csv&gid=",GID), envir = globalenv())
cat(paste0("The data for '", place_name_here, "' has been uploaded in Google Sheets. Its URL is ", "'https://docs-proxy.cmucreatelab.org/spreadsheets/d/",workbook_id,"/export?format=csv&gid=",GID, "' and can now be copied from the Global Environment.\n\n"))
}
overwrite_sheet(UK2, "1iGCWUxvMl_E1IvxB2A-uXibCMSKAyT80vugKW6yutOk", "1105467732", share_with_anyone = FALSE)
overwrite_sheet  <- function(dataframe, spreadsheetId, sheetId, sheet_name = NULL, display_sheet_in_browser=FALSE, share_with_anyone=TRUE){
if(missing(sheet_name)){
ss <- googlesheets4::as_sheets_id(paste0("https://docs.google.com/spreadsheets/d/", spreadsheetId, "/edit#gid=", sheetId))
googlesheets4::sheet_write(dataframe, ss = ss, sheet = "Sheet1")
}
else{
ss <- googlesheets4::as_sheets_id(paste0("https://docs.google.com/spreadsheets/d/", spreadsheetId, "/edit#gid=", sheetId))
googlesheets4::sheet_write(dataframe, ss = ss, sheet = sheet_name)
}
place_name_here <- deparse(substitute(dataframe))  # Apply deparse & substitute # Show object name as character string
if(display_sheet_in_browser==FALSE){
cat(crayon::green$bold("\nCONGRATULATIONS:" %+% reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded and is ready to be used in EarthTime!\n\n")))))
}
else{
googlesheets4::gs4_browse(ss)
}
if(share_with_anyone==TRUE){
googledrive::drive_share_anyone(googledrive::as_id(ss))
}
else{
cat(crayon::red$bold$underline("\nWARNING:" %+% reset(" You've chosen to not make " %+% bgYellow(place_name_here %+% reset(" available to anyone with the link. Please keep in mind that you will need to later change permissions to 'anyone with the link' if you want this data layer to be available in EarthTime!\n\n")))))
}
GID <- googlesheets4::sheet_properties(ss)[1,3] #Extracts GID of first sheet in the workbook—ideally this should be the only sheet in the workbook
workbook_id <- read.table(text=gsub("\\ID:", " ", ss))
assign(paste0(place_name_here, "_URL"), paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/",workbook_id,"/export?format=csv&gid=",GID), envir = globalenv())
cat(crayon::yellow$bold("\nATTENTION:" %+% reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded in Google Sheets. Its URL is"
%+% blue$underline("https://docs-proxy.cmucreatelab.org/spreadsheets/d/" workbook_id "/export?format=csv&gid=" GID
%+% reset(and can now be copied from the Global Environment.\n\n)                                                                                           )                                                                                             )))))
}
overwrite_sheet  <- function(dataframe, spreadsheetId, sheetId, sheet_name = NULL, display_sheet_in_browser=FALSE, share_with_anyone=TRUE){
if(missing(sheet_name)){
ss <- googlesheets4::as_sheets_id(paste0("https://docs.google.com/spreadsheets/d/", spreadsheetId, "/edit#gid=", sheetId))
googlesheets4::sheet_write(dataframe, ss = ss, sheet = "Sheet1")
}
else{
ss <- googlesheets4::as_sheets_id(paste0("https://docs.google.com/spreadsheets/d/", spreadsheetId, "/edit#gid=", sheetId))
googlesheets4::sheet_write(dataframe, ss = ss, sheet = sheet_name)
}
place_name_here <- deparse(substitute(dataframe))  # Apply deparse & substitute # Show object name as character string
if(display_sheet_in_browser==FALSE){
cat(crayon::green$bold("\nCONGRATULATIONS:" %+% reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded and is ready to be used in EarthTime!\n\n")))))
}
else{
googlesheets4::gs4_browse(ss)
}
if(share_with_anyone==TRUE){
googledrive::drive_share_anyone(googledrive::as_id(ss))
}
else{
cat(crayon::red$bold$underline("\nWARNING:" %+% reset(" You've chosen to not make " %+% bgYellow(place_name_here %+% reset(" available to anyone with the link. Please keep in mind that you will need to later change permissions to 'anyone with the link' if you want this data layer to be available in EarthTime!\n\n")))))
}
GID <- googlesheets4::sheet_properties(ss)[1,3] #Extracts GID of first sheet in the workbook—ideally this should be the only sheet in the workbook
workbook_id <- read.table(text=gsub("\\ID:", " ", ss))
assign(paste0(place_name_here, "_URL"), paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/",workbook_id,"/export?format=csv&gid=",GID), envir = globalenv())
cat(crayon::yellow$bold("\nATTENTION:" %+% reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded in Google Sheets. Its URL is" %+% blue$underline("https://docs-proxy.cmucreatelab.org/spreadsheets/d/" workbook_id "/export?format=csv&gid=" GID %+% reset(and can now be copied from the Global Environment.\n\n)))))))
}
overwrite_sheet  <- function(dataframe, spreadsheetId, sheetId, sheet_name = NULL, display_sheet_in_browser=FALSE, share_with_anyone=TRUE){
if(missing(sheet_name)){
ss <- googlesheets4::as_sheets_id(paste0("https://docs.google.com/spreadsheets/d/", spreadsheetId, "/edit#gid=", sheetId))
googlesheets4::sheet_write(dataframe, ss = ss, sheet = "Sheet1")
}
else{
ss <- googlesheets4::as_sheets_id(paste0("https://docs.google.com/spreadsheets/d/", spreadsheetId, "/edit#gid=", sheetId))
googlesheets4::sheet_write(dataframe, ss = ss, sheet = sheet_name)
}
place_name_here <- deparse(substitute(dataframe))  # Apply deparse & substitute # Show object name as character string
if(display_sheet_in_browser==FALSE){
cat(crayon::green$bold("\nCONGRATULATIONS:" %+% reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded and is ready to be used in EarthTime!\n\n")))))
}
else{
googlesheets4::gs4_browse(ss)
}
if(share_with_anyone==TRUE){
googledrive::drive_share_anyone(googledrive::as_id(ss))
}
else{
cat(crayon::red$bold$underline("\nWARNING:" %+% reset(" You've chosen to not make " %+% bgYellow(place_name_here %+% reset(" available to anyone with the link. Please keep in mind that you will need to later change permissions to 'anyone with the link' if you want this data layer to be available in EarthTime!\n\n")))))
}
GID <- googlesheets4::sheet_properties(ss)[1,3] #Extracts GID of first sheet in the workbook—ideally this should be the only sheet in the workbook
workbook_id <- read.table(text=gsub("\\ID:", " ", ss))
assign(paste0(place_name_here, "_URL"), paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/",workbook_id,"/export?format=csv&gid=",GID), envir = globalenv())
cat(crayon::yellow$bold("\nATTENTION:" %+% reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded in Google Sheets. Its URL is" %+% blue$underline(paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/", workbook_id, "/export?format=csv&gid=" GID) %+% reset(and can now be copied from the Global Environment.\n\n)))))))
}
overwrite_sheet  <- function(dataframe, spreadsheetId, sheetId, sheet_name = NULL, display_sheet_in_browser=FALSE, share_with_anyone=TRUE){
if(missing(sheet_name)){
ss <- googlesheets4::as_sheets_id(paste0("https://docs.google.com/spreadsheets/d/", spreadsheetId, "/edit#gid=", sheetId))
googlesheets4::sheet_write(dataframe, ss = ss, sheet = "Sheet1")
}
else{
ss <- googlesheets4::as_sheets_id(paste0("https://docs.google.com/spreadsheets/d/", spreadsheetId, "/edit#gid=", sheetId))
googlesheets4::sheet_write(dataframe, ss = ss, sheet = sheet_name)
}
place_name_here <- deparse(substitute(dataframe))  # Apply deparse & substitute # Show object name as character string
if(display_sheet_in_browser==FALSE){
cat(crayon::green$bold("\nCONGRATULATIONS:" %+% reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded and is ready to be used in EarthTime!\n\n")))))
}
else{
googlesheets4::gs4_browse(ss)
}
if(share_with_anyone==TRUE){
googledrive::drive_share_anyone(googledrive::as_id(ss))
}
else{
cat(crayon::red$bold$underline("\nWARNING:" %+% reset(" You've chosen to not make " %+% bgYellow(place_name_here %+% reset(" available to anyone with the link. Please keep in mind that you will need to later change permissions to 'anyone with the link' if you want this data layer to be available in EarthTime!\n\n")))))
}
GID <- googlesheets4::sheet_properties(ss)[1,3] #Extracts GID of first sheet in the workbook—ideally this should be the only sheet in the workbook
workbook_id <- read.table(text=gsub("\\ID:", " ", ss))
assign(paste0(place_name_here, "_URL"), paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/",workbook_id,"/export?format=csv&gid=",GID), envir = globalenv())
cat(crayon::yellow$bold("\nATTENTION:" %+% reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded in Google Sheets. Its URL is" %+% blue$underline("https://docs-proxy.cmucreatelab.org/spreadsheets/d/" workbook_id "/export?format=csv&gid=" GID %+% reset("and can now be copied from the Global Environment.\n\n")))))))
}
overwrite_sheet  <- function(dataframe, spreadsheetId, sheetId, sheet_name = NULL, display_sheet_in_browser=FALSE, share_with_anyone=TRUE){
if(missing(sheet_name)){
ss <- googlesheets4::as_sheets_id(paste0("https://docs.google.com/spreadsheets/d/", spreadsheetId, "/edit#gid=", sheetId))
googlesheets4::sheet_write(dataframe, ss = ss, sheet = "Sheet1")
}
else{
ss <- googlesheets4::as_sheets_id(paste0("https://docs.google.com/spreadsheets/d/", spreadsheetId, "/edit#gid=", sheetId))
googlesheets4::sheet_write(dataframe, ss = ss, sheet = sheet_name)
}
place_name_here <- deparse(substitute(dataframe))  # Apply deparse & substitute # Show object name as character string
if(display_sheet_in_browser==FALSE){
cat(crayon::green$bold("\nCONGRATULATIONS:" %+% reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded and is ready to be used in EarthTime!\n\n")))))
}
else{
googlesheets4::gs4_browse(ss)
}
if(share_with_anyone==TRUE){
googledrive::drive_share_anyone(googledrive::as_id(ss))
}
else{
cat(crayon::red$bold$underline("\nWARNING:" %+% reset(" You've chosen to not make " %+% bgYellow(place_name_here %+% reset(" available to anyone with the link. Please keep in mind that you will need to later change permissions to 'anyone with the link' if you want this data layer to be available in EarthTime!\n\n")))))
}
GID <- googlesheets4::sheet_properties(ss)[1,3] #Extracts GID of first sheet in the workbook—ideally this should be the only sheet in the workbook
workbook_id <- read.table(text=gsub("\\ID:", " ", ss))
assign(paste0(place_name_here, "_URL"), paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/",workbook_id,"/export?format=csv&gid=",GID), envir = globalenv())
cat(crayon::yellow$bold("\nATTENTION:" %+% reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded in Google Sheets. Its URL is" %+% blue$underline("https://docs-proxy.cmucreatelab.org/spreadsheets/d/" workbook_id "/export?format=csv&gid=" GID %+% reset("and can now be copied from the Global Environment!\n\n"))))))
}
overwrite_sheet  <- function(dataframe, spreadsheetId, sheetId, sheet_name = NULL, display_sheet_in_browser=FALSE, share_with_anyone=TRUE){
if(missing(sheet_name)){
ss <- googlesheets4::as_sheets_id(paste0("https://docs.google.com/spreadsheets/d/", spreadsheetId, "/edit#gid=", sheetId))
googlesheets4::sheet_write(dataframe, ss = ss, sheet = "Sheet1")
}
else{
ss <- googlesheets4::as_sheets_id(paste0("https://docs.google.com/spreadsheets/d/", spreadsheetId, "/edit#gid=", sheetId))
googlesheets4::sheet_write(dataframe, ss = ss, sheet = sheet_name)
}
place_name_here <- deparse(substitute(dataframe))  # Apply deparse & substitute # Show object name as character string
if(display_sheet_in_browser==FALSE){
cat(crayon::green$bold("\nCONGRATULATIONS:" %+% reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded and is ready to be used in EarthTime!\n\n")))))
}
else{
googlesheets4::gs4_browse(ss)
}
if(share_with_anyone==TRUE){
googledrive::drive_share_anyone(googledrive::as_id(ss))
}
else{
cat(crayon::red$bold$underline("\nWARNING:" %+% reset(" You've chosen to not make " %+% bgYellow(place_name_here %+% reset(" available to anyone with the link. Please keep in mind that you will need to later change permissions to 'anyone with the link' if you want this data layer to be available in EarthTime!\n\n")))))
}
GID <- googlesheets4::sheet_properties(ss)[1,3] #Extracts GID of first sheet in the workbook—ideally this should be the only sheet in the workbook
workbook_id <- read.table(text=gsub("\\ID:", " ", ss))
assign(paste0(place_name_here, "_URL"), paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/",workbook_id,"/export?format=csv&gid=",GID), envir = globalenv())
cat(crayon::yellow$bold("\nATTENTION:" %+% reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded in Google Sheets. Its URL is" %+% blue$underline("https://docs-proxy.cmucreatelab.org/spreadsheets/d/" workbook_id "/export?format=csv&gid=" GID %+% reset("and can now be copied from the Global Environment!\n\n"))))))))
}
overwrite_sheet  <- function(dataframe, spreadsheetId, sheetId, sheet_name = NULL, display_sheet_in_browser=FALSE, share_with_anyone=TRUE){
if(missing(sheet_name)){
ss <- googlesheets4::as_sheets_id(paste0("https://docs.google.com/spreadsheets/d/", spreadsheetId, "/edit#gid=", sheetId))
googlesheets4::sheet_write(dataframe, ss = ss, sheet = "Sheet1")
}
else{
ss <- googlesheets4::as_sheets_id(paste0("https://docs.google.com/spreadsheets/d/", spreadsheetId, "/edit#gid=", sheetId))
googlesheets4::sheet_write(dataframe, ss = ss, sheet = sheet_name)
}
place_name_here <- deparse(substitute(dataframe))  # Apply deparse & substitute # Show object name as character string
if(display_sheet_in_browser==FALSE){
cat(crayon::green$bold("\nCONGRATULATIONS:" %+% reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded and is ready to be used in EarthTime!\n\n")))))
}
else{
googlesheets4::gs4_browse(ss)
}
if(share_with_anyone==TRUE){
googledrive::drive_share_anyone(googledrive::as_id(ss))
}
else{
cat(crayon::red$bold$underline("\nWARNING:" %+% reset(" You've chosen to not make " %+% bgYellow(place_name_here %+% reset(" available to anyone with the link. Please keep in mind that you will need to later change permissions to 'anyone with the link' if you want this data layer to be available in EarthTime!\n\n")))))
}
GID <- googlesheets4::sheet_properties(ss)[1,3] #Extracts GID of first sheet in the workbook—ideally this should be the only sheet in the workbook
workbook_id <- read.table(text=gsub("\\ID:", " ", ss))
assign(paste0(place_name_here, "_URL"), paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/",workbook_id,"/export?format=csv&gid=",GID), envir = globalenv())
cat(crayon::yellow$bold("\nATTENTION:" %+% reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded in Google Sheets. Its URL is" %+% blue$underline("https://docs-proxy.cmucreatelab.org/spreadsheets/d/" workbook_id "/export?format=csv&gid=" GID %+% reset("and can now be copied from the Global Environment!\n\n"))))))
}
overwrite_sheet  <- function(dataframe, spreadsheetId, sheetId, sheet_name = NULL, display_sheet_in_browser=FALSE, share_with_anyone=TRUE){
if(missing(sheet_name)){
ss <- googlesheets4::as_sheets_id(paste0("https://docs.google.com/spreadsheets/d/", spreadsheetId, "/edit#gid=", sheetId))
googlesheets4::sheet_write(dataframe, ss = ss, sheet = "Sheet1")
}
else{
ss <- googlesheets4::as_sheets_id(paste0("https://docs.google.com/spreadsheets/d/", spreadsheetId, "/edit#gid=", sheetId))
googlesheets4::sheet_write(dataframe, ss = ss, sheet = sheet_name)
}
place_name_here <- deparse(substitute(dataframe))  # Apply deparse & substitute # Show object name as character string
if(display_sheet_in_browser==FALSE){
cat(crayon::green$bold("\nCONGRATULATIONS:" %+% reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded and is ready to be used in EarthTime!\n\n")))))
}
else{
googlesheets4::gs4_browse(ss)
}
if(share_with_anyone==TRUE){
googledrive::drive_share_anyone(googledrive::as_id(ss))
}
else{
cat(crayon::red$bold$underline("\nWARNING:" %+% reset(" You've chosen to not make " %+% bgYellow(place_name_here %+% reset(" available to anyone with the link. Please keep in mind that you will need to later change permissions to 'anyone with the link' if you want this data layer to be available in EarthTime!\n\n")))))
}
GID <- googlesheets4::sheet_properties(ss)[1,3] #Extracts GID of first sheet in the workbook—ideally this should be the only sheet in the workbook
workbook_id <- read.table(text=gsub("\\ID:", " ", ss))
assign(paste0(place_name_here, "_URL"), paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/",workbook_id,"/export?format=csv&gid=",GID), envir = globalenv())
cat(crayon::yellow$bold("\nATTENTION:" %+% reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded in Google Sheets. Its URL is" %+% blue$underline("https://docs-proxy.cmucreatelab.org/spreadsheets/d/", workbook_id, "/export?format=csv&gid=", GID %+% reset("and can now be copied from the Global Environment!\n\n")))))))
}
overwrite_sheet(UK2, "1iGCWUxvMl_E1IvxB2A-uXibCMSKAyT80vugKW6yutOk", "1105467732", share_with_anyone = TRUE)
overwrite_sheet  <- function(dataframe, spreadsheetId, sheetId, sheet_name = NULL, display_sheet_in_browser=FALSE, share_with_anyone=TRUE){
if(missing(sheet_name)){
ss <- googlesheets4::as_sheets_id(paste0("https://docs.google.com/spreadsheets/d/", spreadsheetId, "/edit#gid=", sheetId))
googlesheets4::sheet_write(dataframe, ss = ss, sheet = "Sheet1")
}
else{
ss <- googlesheets4::as_sheets_id(paste0("https://docs.google.com/spreadsheets/d/", spreadsheetId, "/edit#gid=", sheetId))
googlesheets4::sheet_write(dataframe, ss = ss, sheet = sheet_name)
}
place_name_here <- deparse(substitute(dataframe))  # Apply deparse & substitute # Show object name as character string
if(display_sheet_in_browser==FALSE){
cat(crayon::green$bold("\nCONGRATULATIONS:" %+% reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded and is ready to be used in EarthTime!\n\n")))))
}
else{
googlesheets4::gs4_browse(ss)
}
if(share_with_anyone==TRUE){
googledrive::drive_share_anyone(googledrive::as_id(ss))
}
else{
cat(crayon::red$bold$underline("\nWARNING:" %+% reset(" You've chosen to not make " %+% bgYellow(place_name_here %+% reset(" available to anyone with the link. Please keep in mind that you will need to later change permissions to 'anyone with the link' if you want this data layer to be available in EarthTime!\n\n")))))
}
GID <- googlesheets4::sheet_properties(ss)[1,3] #Extracts GID of first sheet in the workbook—ideally this should be the only sheet in the workbook
workbook_id <- read.table(text=gsub("\\ID:", " ", ss))
assign(paste0(place_name_here, "_URL"), paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/",workbook_id,"/export?format=csv&gid=",GID), envir = globalenv())
cat(crayon::yellow$bold("\nATTENTION:" %+% reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded in Google Sheets. Its URL is" %+% blue$underline("https://docs-proxy.cmucreatelab.org/spreadsheets/d/", workbook_id, "/export?format=csv&gid=", GID)))))), crayon::reset("and can now be copied from the Global Environment!\n\n")
}
overwrite_sheet  <- function(dataframe, spreadsheetId, sheetId, sheet_name = NULL, display_sheet_in_browser=FALSE, share_with_anyone=TRUE){
if(missing(sheet_name)){
ss <- googlesheets4::as_sheets_id(paste0("https://docs.google.com/spreadsheets/d/", spreadsheetId, "/edit#gid=", sheetId))
googlesheets4::sheet_write(dataframe, ss = ss, sheet = "Sheet1")
}
else{
ss <- googlesheets4::as_sheets_id(paste0("https://docs.google.com/spreadsheets/d/", spreadsheetId, "/edit#gid=", sheetId))
googlesheets4::sheet_write(dataframe, ss = ss, sheet = sheet_name)
}
place_name_here <- deparse(substitute(dataframe))  # Apply deparse & substitute # Show object name as character string
if(display_sheet_in_browser==FALSE){
cat(crayon::green$bold("\nCONGRATULATIONS:" %+% reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded and is ready to be used in EarthTime!\n\n")))))
}
else{
googlesheets4::gs4_browse(ss)
}
if(share_with_anyone==TRUE){
googledrive::drive_share_anyone(googledrive::as_id(ss))
}
else{
cat(crayon::red$bold$underline("\nWARNING:" %+% reset(" You've chosen to not make " %+% bgYellow(place_name_here %+% reset(" available to anyone with the link. Please keep in mind that you will need to later change permissions to 'anyone with the link' if you want this data layer to be available in EarthTime!\n\n")))))
}
GID <- googlesheets4::sheet_properties(ss)[1,3] #Extracts GID of first sheet in the workbook—ideally this should be the only sheet in the workbook
workbook_id <- read.table(text=gsub("\\ID:", " ", ss))
assign(paste0(place_name_here, "_URL"), paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/",workbook_id,"/export?format=csv&gid=",GID), envir = globalenv())
cat(crayon::yellow$bold("\nATTENTION:" %+% reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded in Google Sheets. Its URL is" %+% blue$underline(paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/", workbook_id, "/export?format=csv&gid=", GID) %+% reset("and can now be copied from the Global Environment!\n\n")))))))
}
overwrite_sheet(UK2, "1iGCWUxvMl_E1IvxB2A-uXibCMSKAyT80vugKW6yutOk", "1105467732", share_with_anyone = TRUE)
overwrite_sheet  <- function(dataframe, spreadsheetId, sheetId, sheet_name = NULL, display_sheet_in_browser=FALSE, share_with_anyone=TRUE){
if(missing(sheet_name)){
ss <- googlesheets4::as_sheets_id(paste0("https://docs.google.com/spreadsheets/d/", spreadsheetId, "/edit#gid=", sheetId))
googlesheets4::sheet_write(dataframe, ss = ss, sheet = "Sheet1")
}
else{
ss <- googlesheets4::as_sheets_id(paste0("https://docs.google.com/spreadsheets/d/", spreadsheetId, "/edit#gid=", sheetId))
googlesheets4::sheet_write(dataframe, ss = ss, sheet = sheet_name)
}
place_name_here <- deparse(substitute(dataframe))  # Apply deparse & substitute # Show object name as character string
if(display_sheet_in_browser==FALSE){
cat(crayon::green$bold("\nCONGRATULATIONS:" %+% reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded and is ready to be used in EarthTime!\n\n")))))
}
else{
googlesheets4::gs4_browse(ss)
}
if(share_with_anyone==TRUE){
googledrive::drive_share_anyone(googledrive::as_id(ss))
}
else{
cat(crayon::red$bold$underline("\nWARNING:" %+% reset(" You've chosen to not make " %+% bgYellow(place_name_here %+% reset(" available to anyone with the link. Please keep in mind that you will need to later change permissions to 'anyone with the link' if you want this data layer to be available in EarthTime!\n\n")))))
}
GID <- googlesheets4::sheet_properties(ss)[1,3] #Extracts GID of first sheet in the workbook—ideally this should be the only sheet in the workbook
workbook_id <- read.table(text=gsub("\\ID:", " ", ss))
overwrite_sheet  <- function(dataframe, spreadsheetId, sheetId, sheet_name = NULL, display_sheet_in_browser=FALSE, share_with_anyone=TRUE){
if(missing(sheet_name)){
ss <- googlesheets4::as_sheets_id(paste0("https://docs.google.com/spreadsheets/d/", spreadsheetId, "/edit#gid=", sheetId))
googlesheets4::sheet_write(dataframe, ss = ss, sheet = "Sheet1")
}
else{
ss <- googlesheets4::as_sheets_id(paste0("https://docs.google.com/spreadsheets/d/", spreadsheetId, "/edit#gid=", sheetId))
googlesheets4::sheet_write(dataframe, ss = ss, sheet = sheet_name)
}
place_name_here <- deparse(substitute(dataframe))  # Apply deparse & substitute # Show object name as character string
if(display_sheet_in_browser==FALSE){
cat(crayon::green$bold("\nCONGRATULATIONS:" %+% reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded and is ready to be used in EarthTime!\n\n")))))
}
else{
googlesheets4::gs4_browse(ss)
}
if(share_with_anyone==TRUE){
googledrive::drive_share_anyone(googledrive::as_id(ss))
}
else{
cat(crayon::red$bold$underline("\nWARNING:" %+% reset(" You've chosen to not make " %+% bgYellow(place_name_here %+% reset(" available to anyone with the link. Please keep in mind that you will need to later change permissions to 'anyone with the link' if you want this data layer to be available in EarthTime!\n\n")))))
}
GID <- googlesheets4::sheet_properties(ss)[1,3] #Extracts GID of first sheet in the workbook—ideally this should be the only sheet in the workbook
workbook_id <- read.table(text=gsub("\\ID:", " ", ss))
assign(paste0(place_name_here, "_URL"), paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/",workbook_id,"/export?format=csv&gid=",GID), envir = globalenv())
cat(crayon::yellow$bold("\nATTENTION:" %+% reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded in Google Sheets. Its URL is " %+% blue$underline(paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/", workbook_id, "/export?format=csv&gid=", GID) %+% reset(" and can now be copied from the Global Environment!\n\n")))))))
}
overwrite_sheet(UK2, "1iGCWUxvMl_E1IvxB2A-uXibCMSKAyT80vugKW6yutOk", "1105467732", share_with_anyone = TRUE)
overwrite_sheet  <- function(dataframe, spreadsheetId, sheetId, sheet_name = NULL, display_sheet_in_browser=FALSE, share_with_anyone=TRUE){
if(missing(sheet_name)){
ss <- googlesheets4::as_sheets_id(paste0("https://docs.google.com/spreadsheets/d/", spreadsheetId, "/edit#gid=", sheetId))
googlesheets4::sheet_write(dataframe, ss = ss, sheet = "Sheet1")
}
else{
ss <- googlesheets4::as_sheets_id(paste0("https://docs.google.com/spreadsheets/d/", spreadsheetId, "/edit#gid=", sheetId))
googlesheets4::sheet_write(dataframe, ss = ss, sheet = sheet_name)
}
place_name_here <- deparse(substitute(dataframe))  # Apply deparse & substitute # Show object name as character string
if(display_sheet_in_browser==FALSE){
cat(crayon::green$bold("\nCONGRATULATIONS:" %+% reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded and is ready to be used in EarthTime!\n\n")))))
}
else{
googlesheets4::gs4_browse(ss)
}
if(share_with_anyone==TRUE){
suppressMessages(googledrive::drive_share_anyone(googledrive::as_id(ss)))
cat(crayon::yellow$bold("\nAttention:" %+% reset(" Sharing permissions for data in " %+% bgYellow(place_name_here %+% reset(" are now set to anyone on the internet with this link can view.\n\n")))))
}
else{
cat(crayon::red$bold$underline("\nWARNING:" %+% reset(" You've chosen to not make " %+% bgYellow(place_name_here %+% reset(" available to anyone with the link. Please keep in mind that you will need to later change permissions to 'anyone with the link' if you want this data layer to be available in EarthTime!\n\n")))))
}
GID <- googlesheets4::sheet_properties(ss)[1,3] #Extracts GID of first sheet in the workbook—ideally this should be the only sheet in the workbook
workbook_id <- read.table(text=gsub("\\ID:", " ", ss))
assign(paste0(place_name_here, "_URL"), paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/",workbook_id,"/export?format=csv&gid=",GID), envir = globalenv())
cat(crayon::yellow$bold("\nATTENTION:" %+% reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded in Google Sheets. Its URL is " %+% blue$underline(paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/", workbook_id, "/export?format=csv&gid=", GID) %+% reset(" and can now be copied from the Global Environment!\n\n")))))))
}
overwrite_sheet(UK2, "1iGCWUxvMl_E1IvxB2A-uXibCMSKAyT80vugKW6yutOk", "1105467732", share_with_anyone = TRUE)
initial_ingestion  <- function(dataframe, data_layer_name, display_sheet_in_browser=FALSE, share_with_anyone=TRUE){
Sheet1 <- dataframe
new_sheet <- googlesheets4::gs4_create(name = data_layer_name, sheets = Sheet1)
place_name_here <- deparse(substitute(dataframe))  # Apply deparse & substitute # Show object name as character string
if(display_sheet_in_browser==FALSE){
cat(crayon::green$bold("\nCONGRATULATIONS:" %+% reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded and is ready to be used in EarthTime!\n\n")))))
}
else{
googlesheets4::gs4_browse(new_sheet)
}
if(share_with_anyone==TRUE){
suppressMessages(googledrive::drive_share_anyone(googledrive::as_id(new_sheet)))
cat(crayon::yellow$bold("\nAttention:" %+% reset(" Sharing permissions for data in " %+% bgYellow(place_name_here %+% reset(" are now set to anyone on the internet with this link can view.\n\n")))))
}
else{
cat(crayon::red$bold$underline("\nWARNING:" %+% reset(" You've chosen to not make " %+% bgYellow(place_name_here %+% reset(" available to anyone with the link. Please keep in mind that you will need to later change permissions to 'anyone with the link' if you want this data layer to be available in EarthTime!\n\n")))))
}
GID <- googlesheets4::sheet_properties(new_sheet)[1,3] #Extracts GID of first sheet in the workbook—ideally this should be the only sheet in the workbook
workbook_id <- read.table(text=gsub("\\ID:", " ", new_sheet))
assign(paste0(place_name_here, "_URL"), paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/",workbook_id,"/export?format=csv&gid=",GID), envir = globalenv())
cat(crayon::yellow$bold("\nATTENTION:" %+% reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded in Google Sheets. Its URL is " %+% blue$underline(paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/", workbook_id, "/export?format=csv&gid=", GID) %+% reset(" and can now be copied from the Global Environment!\n\n")))))))
}
initial_ingestion(UK2, "testing again5", share_with_anyone = TRUE)
initial_ingestion  <- function(dataframe, data_layer_name, display_sheet_in_browser=FALSE, share_with_anyone=TRUE){
Sheet1 <- dataframe
new_sheet <- googlesheets4::gs4_create(name = data_layer_name, sheets = Sheet1)
place_name_here <- deparse(substitute(dataframe))  # Apply deparse & substitute # Show object name as character string
if(display_sheet_in_browser==FALSE){
cat(crayon::green$bold("\nCONGRATULATIONS:" %+% reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded and is ready to be used in EarthTime!\n\n")))))
}
else{
googlesheets4::gs4_browse(new_sheet)
}
if(share_with_anyone==TRUE){
suppressMessages(googledrive::drive_share_anyone(googledrive::as_id(new_sheet)))
cat(crayon::yellow$bold("\nATTENTION:" %+% reset(" Sharing permissions for data in " %+% bgYellow(place_name_here %+% reset(" are now set to anyone on the internet with this link can view.\n\n")))))
}
else{
cat(crayon::red$bold$underline("\nWARNING:" %+% reset(" You've chosen to not make " %+% bgYellow(place_name_here %+% reset(" available to anyone with the link. Please keep in mind that you will need to later change permissions to 'anyone with the link' if you want this data layer to be available in EarthTime!\n\n")))))
}
GID <- googlesheets4::sheet_properties(new_sheet)[1,3] #Extracts GID of first sheet in the workbook—ideally this should be the only sheet in the workbook
workbook_id <- read.table(text=gsub("\\ID:", " ", new_sheet))
assign(paste0(place_name_here, "_URL"), paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/",workbook_id,"/export?format=csv&gid=",GID), envir = globalenv())
cat(crayon::magenta$bold("\nNOTE:" %+% reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded in Google Sheets. Its URL is " %+% blue$underline(paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/", workbook_id, "/export?format=csv&gid=", GID) %+% reset(" and can now be copied from the Global Environment!\n\n")))))))
}
overwrite_sheet  <- function(dataframe, spreadsheetId, sheetId, sheet_name = NULL, display_sheet_in_browser=FALSE, share_with_anyone=TRUE){
if(missing(sheet_name)){
ss <- googlesheets4::as_sheets_id(paste0("https://docs.google.com/spreadsheets/d/", spreadsheetId, "/edit#gid=", sheetId))
googlesheets4::sheet_write(dataframe, ss = ss, sheet = "Sheet1")
}
else{
ss <- googlesheets4::as_sheets_id(paste0("https://docs.google.com/spreadsheets/d/", spreadsheetId, "/edit#gid=", sheetId))
googlesheets4::sheet_write(dataframe, ss = ss, sheet = sheet_name)
}
place_name_here <- deparse(substitute(dataframe))  # Apply deparse & substitute # Show object name as character string
if(display_sheet_in_browser==FALSE){
cat(crayon::green$bold("\nCONGRATULATIONS:" %+% reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded and is ready to be used in EarthTime!\n\n")))))
}
else{
googlesheets4::gs4_browse(ss)
}
if(share_with_anyone==TRUE){
suppressMessages(googledrive::drive_share_anyone(googledrive::as_id(ss)))
cat(crayon::yellow$bold("\nATTENTION:" %+% reset(" Sharing permissions for data in " %+% bgYellow(place_name_here %+% reset(" are now set to anyone on the internet with this link can view.\n\n")))))
}
else{
cat(crayon::red$bold$underline("\nWARNING:" %+% reset(" You've chosen to not make " %+% bgYellow(place_name_here %+% reset(" available to anyone with the link. Please keep in mind that you will need to later change permissions to 'anyone with the link' if you want this data layer to be available in EarthTime!\n\n")))))
}
GID <- googlesheets4::sheet_properties(ss)[1,3] #Extracts GID of first sheet in the workbook—ideally this should be the only sheet in the workbook
workbook_id <- read.table(text=gsub("\\ID:", " ", ss))
assign(paste0(place_name_here, "_URL"), paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/",workbook_id,"/export?format=csv&gid=",GID), envir = globalenv())
cat(crayon::magenta$bold("\nNOTE:" %+% reset(" The data for " %+% bgYellow(place_name_here %+% reset(" has been uploaded in Google Sheets. Its URL is " %+% blue$underline(paste0("https://docs-proxy.cmucreatelab.org/spreadsheets/d/", workbook_id, "/export?format=csv&gid=", GID) %+% reset(" and can now be copied from the Global Environment!\n\n")))))))
}
initial_ingestion(UK2, "testing again5", share_with_anyone = TRUE)
overwrite_sheet(UK2, "1iGCWUxvMl_E1IvxB2A-uXibCMSKAyT80vugKW6yutOk", "1105467732", share_with_anyone = TRUE)
overwrite_sheet(UK2, "1iGCWUxvMl_E1IvxB2A-uXibCMSKAyT80vugKW6yutOk", "1105467732", share_with_anyone = FALSE)
library("devtools")
library("roxygen2")
setwd("C:/Users/ABERK/Box/The_Definitive_ABERK_Data_Science_Folder")
setwd("./EarthTimeR")
document()
detach("package:EarthTimeR", unload = TRUE)
devtools::install_github("andrewcberkley/EarthTimeR", force = TRUE)
library("EarthTimeR")
library("devtools")
library("roxygen2")
setwd("C:/Users/ABERK/Box/The_Definitive_ABERK_Data_Science_Folder")
setwd("./EarthTimeR")
document()
detach("package:EarthTimeR", unload = TRUE)
devtools::install_github("andrewcberkley/EarthTimeR", force = TRUE)
library("EarthTimeR")
library("devtools")
library("roxygen2")
setwd("C:/Users/ABERK/Box/The_Definitive_ABERK_Data_Science_Folder")
setwd("./EarthTimeR")
document()
library("devtools")
library("roxygen2")
setwd("C:/Users/ABERK/Box/The_Definitive_ABERK_Data_Science_Folder")
setwd("./EarthTimeR")
document()
detach("package:EarthTimeR", unload = TRUE)
devtools::install_github("andrewcberkley/EarthTimeR", force = TRUE)
library("EarthTimeR")
